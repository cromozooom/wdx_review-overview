<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="generator" content="Hugo 0.119.0" />
    <meta charset="utf-8" />
    <title></title>

    <link
      href="/scss/styles.5ef0165a5b9b4c40f3d6ed8e6e3ea506838e8a7f272eaf47e0a2bbd49af835b8.css"
      rel="stylesheet"
    />

    <script src="/js/index.js" integrity="" defer></script>

    <script defer src="/js/cdn.min.js"></script>
  </head>
  <body
    x-data="entityComponent()"
    x-init="loadData()"
    class="w-100 h-100 d-flex"
  >
    <template x-if="!widgetOnly">
      <nav class="h-100 p-2 border-end bg-light d-flex flex-column">
        <ul class="list-unstyled">
          <li>
            <button class="border-0 btn btn-link btn-lg bg-transparent">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-house"
                viewBox="0 0 16 16"
              >
                <path
                  d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"
                />
              </svg>
            </button>
          </li>
          <li>
            <button class="border-0 btn btn-link btn-lg bg-transparent">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-speedometer"
                viewBox="0 0 16 16"
              >
                <path
                  d="M8 2a.5.5 0 0 1 .5.5V4a.5.5 0 0 1-1 0V2.5A.5.5 0 0 1 8 2M3.732 3.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707M2 8a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 8m9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5m.754-4.246a.39.39 0 0 0-.527-.02L7.547 7.31A.91.91 0 1 0 8.85 8.569l3.434-4.297a.39.39 0 0 0-.029-.518z"
                />
                <path
                  fill-rule="evenodd"
                  d="M6.664 15.889A8 8 0 1 1 9.336.11a8 8 0 0 1-2.672 15.78zm-4.665-4.283A11.95 11.95 0 0 1 8 10c2.186 0 4.236.585 6.001 1.606a7 7 0 1 0-12.002 0"
                />
              </svg>
            </button>
          </li>
          <li>
            <button class="border-0 btn btn-link btn-lg bg-transparent">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-backspace-reverse"
                viewBox="0 0 16 16"
              >
                <path
                  d="M9.854 5.146a.5.5 0 0 1 0 .708L7.707 8l2.147 2.146a.5.5 0 0 1-.708.708L7 8.707l-2.146 2.147a.5.5 0 0 1-.708-.708L6.293 8 4.146 5.854a.5.5 0 1 1 .708-.708L7 7.293l2.146-2.147a.5.5 0 0 1 .708 0"
                />
                <path
                  d="M2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7.08a2 2 0 0 0 1.519-.698l4.843-5.651a1 1 0 0 0 0-1.302L10.6 1.7A2 2 0 0 0 9.08 1zm7.08 1a1 1 0 0 1 .76.35L14.682 8l-4.844 5.65a1 1 0 0 1-.759.35H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z"
                />
              </svg>
            </button>
          </li>
          <li>
            <button class="border-0 btn btn-link btn-lg bg-transparent">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-bag"
                viewBox="0 0 16 16"
              >
                <path
                  d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1m3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z"
                />
              </svg>
            </button>
          </li>
        </ul>
      </nav>
    </template>
    <div class="flex-grow-1 d-flex flex-column">
      <header class="d-flex flex-column">
        <template x-if="!widgetOnly">
          <div>
            <section
              class="text-bg-primary p-2 d-flex justify-content-between align-items-center"
            >
              <nav>
                <h1>App Header</h1>
              </nav>
              <div>
                <select
                  class="form-select"
                  aria-label="Default select example"
                  x-model="activeUser"
                >
                  <template x-for="user in users" :key="user.name">
                    <option :value="user.name" x-text="user.name"></option>
                  </template>
                </select>
              </div>
            </section>
            <div class="p-2 border-bottom bg-light">
              <strong> Banner Info </strong>
            </div>
            <div class="p-2 border-bottom bg-light">
              <strong> TAB NAV </strong>
            </div>
          </div>
        </template>

        <div
          class="border-bottom p-2 d-flex justify-content-between hover-opacity"
        >
          <div>
            <input
              type="text"
              class="form-control form-control-lg"
              placeholder="Search by name"
              x-model="searchQuery"
              @input="filterEntities"
            />
          </div>
          <div class="d-flex gap-2">
            <div class="btn-group hover-opacity_el">
              <button
                class="btn btn-outline-primary d-flex align-items-center gap-2"
                @click="widgetOnly = !widgetOnly"
              >
                WidgetOnly
              </button>
              <button
                class="btn btn-outline-primary d-flex align-items-center gap-2"
                @click="duplicateEntity"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-copy"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"
                  />
                </svg>
                Duplicate
              </button>
              <button
                class="btn btn-outline-primary d-flex align-items-center gap-2"
                @click="downloadData"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-cloud-arrow-down"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708z"
                  />
                  <path
                    d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383m.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"
                  />
                </svg>
                JSON
              </button>
              <label
                class="btn btn-outline-primary mb-0 rounded-end d-flex align-items-center gap-2"
                for="uploadInput"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-cloud-arrow-up"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708z"
                  />
                  <path
                    d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383m.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"
                  />
                </svg>
                JSON</label
              >
              <input
                type="file"
                id="uploadInput"
                @change="uploadData"
                class="form-control-file d-none"
              />
            </div>
            <div>
              <template x-if="filteredEntities.length > 1">
                <div class="btn-group">
                  <button
                    class="btn btn-primary btn-lg"
                    @click="previousEntity"
                    :disabled="!hasPrevious"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-arrow-left-short"
                      viewBox="0 0 16 16"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5"
                      />
                    </svg>
                  </button>
                  <button
                    class="btn btn-primary btn-lg"
                    @click="nextEntity"
                    :disabled="!hasNext"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-arrow-right-short"
                      viewBox="0 0 16 16"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                      />
                    </svg>
                  </button>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>
      <!-- Connection Role -->
      <div class="flex-grow-1 p-0 overflow-hidden">
        <main class="h-100 d-flex">
          <section
            id="formSummary"
            class="col-3 gap-0 border-end h-100 d-flex flex-column"
          >
            <div class="overflow-y-scroll flex-grow-1 pb-4" id="editContainer">
              <div class="p-2 border-bottom sticky-top bg-white">
                <h3 class="m-0 p-0">Review Form</h3>
              </div>
              <template x-if="selectedEntityIndex !== null">
                <div
                  data-bs-spy="scroll"
                  data-bs-target="#formSummary"
                  data-bs-offset="0"
                  class="scrollspy-example"
                  tabindex="0"
                >
                  <template
                    x-for="(section, sectionIndex) in entities[selectedEntityIndex].form.sections"
                    :key="section.title"
                  >
                    <div>
                      <button
                        class="mt-4 w-100 d-flex w-100 justify-content-between text-start mb-2 fw-bold border-0 bg-transparent d-flex align-items-center gap-1"
                        x-bind:class="countFields(sectionIndex) === countFilledFields(sectionIndex) ? 'text-success' : 'xtext-warning'"
                        @click="scrollFormToSection(sectionIndex, 'scroll-form-section')"
                      >
                        <div class="h5">
                          <span
                            x-bind:class="countFields(sectionIndex) === countFilledFields(sectionIndex) ? 'text-success' : ''"
                          >
                            <svg
                              x-show="countFields(sectionIndex) === countFilledFields(sectionIndex)"
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              fill="currentColor"
                              class="bi bi-check"
                              viewBox="0 0 16 16"
                            >
                              <path
                                d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"
                              />
                            </svg>
                          </span>
                          <span x-text="section.title"></span>
                        </div>
                      </button>
                      <section class="d-flex flex-column border-bottom">
                        <div class="p-2">
                          <p>
                            When applicable, I confirm that I have not
                            identified any risks in the screenings * carried
                            out. *
                          </p>
                          <p>
                            (*) Google keywords search on R4 or R3 relationships
                            (account holder and related parties) + Full JORDAN
                            search on the environment of R4 relationships (all
                            relationships for Singapore). Please attach the
                            results of your research.
                          </p>
                        </div>
                        <div class="p-2 bg-info" style="--bs-bg-opacity: 0.2">
                          <div class="form-check form-switch">
                            <input
                              class="form-check-input"
                              type="checkbox"
                              role="switch"
                              id="flexSwitchCheckDefault"
                            />
                            <label
                              class="form-check-label"
                              for="flexSwitchCheckDefault"
                              >Yes</label
                            >
                          </div>
                        </div>
                      </section>
                      <div class="p-2">
                        <ul class="list-group">
                          <template
                            x-for="(field, fieldIndex) in section.fields"
                            :key="field.name"
                          >
                            <li
                              x-bind:class="fieldIndex ? '' : 'rounded-top'"
                              class="list-group-item"
                              x-text="field.label"
                            ></li>
                          </template>
                        </ul>
                      </div>
                    </div>
                  </template>
                </div>
              </template>
            </div>
            <div class="d-flex gap-2 justify-content-end p-2 border-top">
              <button class="btn btn-primary">Confirm No Change Review</button>
              <button class="btn btn-primary">Full Review</button>
            </div>
          </section>
          <section
            id="users"
            class="col-3 gap-0 border-end h-100 d-flex flex-column"
          >
            <div class="overflow-y-scroll flex-grow-1">
              <div class="d-flex flex-column gap-3 p-2">
                <template
                  x-for="(entity, index) in filteredEntities"
                  :key="entity.id"
                >
                  <button
                    class="cursor-pointer rounded shadow shadow-sm d-block user"
                    style="--bs-bg-opacity: 0.05"
                    x-bind:class="index === selectedEntityIndex ? 'bg-info active' : ''"
                    @click="selectEntity(entity.id, index)"
                    :x-ref="`entity-${index}`"
                    x-ref="`entity-${index}`"
                  >
                    <div
                      class="px-2 py-3 w-100 d-flex justify-content-start flex-column text-start"
                      x-bind:class="index ? 'xborder-top' : ''"
                    >
                      <template x-if="entity.type === 'person'">
                        <div
                          class="d-flex justify-content-between align-items-center pb-2"
                        >
                          <strong
                            class="text-primary"
                            x-text="`${entity.name} ${entity.surname}`"
                          ></strong>
                          <div>
                            <svg
                              x-show="!entityHasHistory(entity)"
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              fill="currentColor"
                              class="bi bi-bell text-muted"
                              viewBox="0 0 16 16"
                            >
                              <path
                                d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6"
                              />
                            </svg>

                            <svg
                              x-show="entityHasHistory(entity)"
                              xmlns="http://www.w3.org/2000/svg"
                              width="16"
                              height="16"
                              fill="currentColor"
                              class="bi bi-bell-fill text-primary"
                              viewBox="0 0 16 16"
                            >
                              <path
                                d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"
                              />
                            </svg>
                          </div>
                        </div>
                      </template>
                      <template x-if="entity.type === 'corporation'">
                        <strong x-text="entity.name"></strong>
                      </template>
                      <div class="row" style="--bs-bg-opacity: 1">
                        <div class="col-6 py-2">Manager</div>
                        <div class="col-6 py-2">
                          <span class="badge text-bg-light me-2">4</span>
                          Mandatory Doc.
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-6 py-2">
                          Risc Level
                          <strong> Low </strong>
                        </div>
                        <div class="col-6 py-2">
                          KYC Update
                          <strong> 12/06/2024 </strong>
                        </div>
                      </div>
                    </div>
                  </button>
                </template>
              </div>
            </div>
          </section>
          <section id="edit" class="col-6 flex-grow-1 h-100 d-flex flex-column">
            <div class="sticky-top bg-white shadow shadow-sm">
              <div style="--bs-bg-opacity: 0.1" class="bg-info text-info">
                <template x-if="selectedEntity !== null">
                  <div
                    class="d-flex align-items-center justify-content-between p-2"
                  >
                    <h1 class="h4 mb-0" x-text="selectedEntity.name"></h1>
                    <div class="btn-group">
                      <button class="btn btn-outline-primary" @click="saveForm">
                        Save Form
                      </button>
                      <button
                        class="btn btn-outline-primary d-flex align-items-center gap-2"
                        @click="showHistory = !showHistory"
                      >
                        <span x-show="showHistory">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-clock-history"
                            viewBox="0 0 16 16"
                          >
                            <path
                              d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"
                            />
                            <path
                              d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"
                            />
                            <path
                              d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"
                            />
                          </svg>
                        </span>
                        <span x-show="!showHistory">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-clock-history"
                            viewBox="0 0 16 16"
                          >
                            <path
                              d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"
                            />
                            <path
                              d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"
                            />
                            <path
                              d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"
                            />
                          </svg>
                        </span>
                        History
                      </button>
                    </div>
                  </div>
                </template>
              </div>
            </div>
            <div class="overflow-y-scroll flex-grow-1" id="editContainer">
              <template x-if="selectedEntity === null">
                <div class="d-flex justify-content-center p-4">
                  <span>Please, select entity ...</span>
                </div>
              </template>
              <template x-if="selectedEntity !== null">
                <div class="py-0">
                  <template
                    x-for="(section, sectionIndex) in selectedEntity.form.sections"
                    :key="section.title"
                  >
                    <div
                      :x-ref="`scroll-form-section${sectionIndex}`"
                      :id="`section${sectionIndex}`"
                      class="section spot"
                    >
                      <div
                        :id="`section${sectionIndex}`"
                        x-bind:class="sectionIndex ? 'border-top' : ''"
                        class="section py-3"
                      >
                        <div class="container-fluid px-0">
                          <div class="row g-0">
                            <div class="col-12 g-0">
                              <h3 x-text="section.title" class="p-2"></h3>
                            </div>
                          </div>
                        </div>
                        <template
                          x-for="(field, fieldIndex) in section.fields"
                          :key="field.name"
                        >
                          <div
                            class="w-100 py-2"
                            :class="showHistory ? 'hover-info-subtile' : ''"
                          >
                            <template x-if="field.type === 'text'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <input
                                      type="text"
                                      class="form-control"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    />
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'email'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <input
                                      type="email"
                                      class="form-control"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    />
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'date'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <input
                                      type="date"
                                      class="form-control"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    />
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'checkbox'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <input
                                      type="checkbox"
                                      class="form-check-input"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    />
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'switch'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-12 g-0 px-2">
                                    <div class="form-check form-switch">
                                      <input
                                        class="form-check-input"
                                        type="checkbox"
                                        role="switch"
                                        id="flexSwitchCheckDefault"
                                        :name="field.name"
                                        :value="field.value"
                                        x-model="field.value"
                                        :required="field.required"
                                      />
                                      <label
                                        class="form-check-label"
                                        for="flexSwitchCheckDefault"
                                        x-text="field.label"
                                      ></label>
                                      <template x-if="field.required">
                                        <span class="text-danger">*</span>
                                      </template>
                                    </div>
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'radio'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <template
                                      x-for="option in field.options"
                                      :key="option.value"
                                    >
                                      <div class="form-check">
                                        <input
                                          class="form-check-input"
                                          type="radio"
                                          :name="field.name"
                                          :value="option.value"
                                          x-model="field.value"
                                          :required="field.required"
                                        />
                                        <label
                                          class="form-check-label"
                                          x-text="option.label"
                                        ></label>
                                      </div>
                                    </template>
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'dropdown'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-4 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-8 pe-2">
                                    <select
                                      class="form-select"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    >
                                      <template
                                        x-for="option in field.options"
                                        :key="option.value"
                                      >
                                        <option
                                          :value="option.value"
                                          x-text="option.label"
                                        ></option>
                                      </template>
                                    </select>
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                            <template x-if="field.type === 'textarea'">
                              <div class="container-fluid px-0 mb-3">
                                <div class="row g-0">
                                  <div class="col-12 g-0 px-2">
                                    <label
                                      class="form-label"
                                      x-text="field.label"
                                    ></label>
                                    <template x-if="field.required">
                                      <span class="text-danger">*</span>
                                    </template>
                                  </div>
                                  <div class="col-12 px-2">
                                    <textarea
                                      class="form-control"
                                      :name="field.name"
                                      x-model="field.value"
                                      :required="field.required"
                                    ></textarea>
                                  </div>
                                </div>
                                <div x-data="{show: false}">
                                  <template x-if="showHistory && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="!historyIndex">
                                        <section
                                          :class="field.history.length >= 2 ? 'history-0' : ''"
                                          class="history pb-3 mx-2"
                                        >
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>
                                              <div
                                                class="d-flex align-items-center btn-group"
                                              >
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>

                                                <template
                                                  x-if="field.history.length >= 2"
                                                >
                                                  <button
                                                    @click="show = !show"
                                                    class="btn btn-sm btn-outline-primary"
                                                  >
                                                    <svg
                                                      x-show="!show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-expand"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10"
                                                      />
                                                    </svg>
                                                    <svg
                                                      x-show="show"
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-arrows-collapse"
                                                      viewBox="0 0 16 16"
                                                    >
                                                      <path
                                                        fill-rule="evenodd"
                                                        d="M1 8a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 8m7-8a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 4.293V.5A.5.5 0 0 1 8 0m-.5 11.707-1.146 1.147a.5.5 0 0 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 11.707V15.5a.5.5 0 0 1-1 0z"
                                                      />
                                                    </svg>
                                                  </button>
                                                </template>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center text-success"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                  <template
                                    x-if="field.history && showHistory && field.history.length > 1"
                                  >
                                    <div class="ps-3">
                                      <button
                                        class="btn btn-sm btn-link"
                                        @click="show = !show"
                                        x-show="!show"
                                        x-text="field.history.length + ' more changes ...'"
                                      ></button>
                                    </div>
                                  </template>
                                  <template x-if="show && field.history">
                                    <template
                                      x-for="(historyItem, historyIndex) in field.history.slice().reverse()"
                                      :key="historyIndex"
                                    >
                                      <template x-if="historyIndex">
                                        <section class="history pb-3 mx-2">
                                          <div class="history--name pt-2 mb-2">
                                            <div
                                              class="d-flex justify-content-between align-items-center"
                                            >
                                              <div>
                                                <small
                                                  ><strong
                                                    ><span
                                                      x-text="historyItem.user"
                                                    ></span
                                                  ></strong>
                                                  <i
                                                    >(
                                                    <span
                                                      x-text="getRole(historyItem.user)"
                                                    ></span>
                                                    )</i
                                                  >
                                                  <span
                                                    x-text="calculateTimeDifference(historyItem.time)"
                                                  ></span
                                                ></small>
                                              </div>

                                              <div class="btn-group">
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="revertHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-arrow-counterclockwise"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      fill-rule="evenodd"
                                                      d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2z"
                                                    />
                                                    <path
                                                      d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466"
                                                    />
                                                  </svg>
                                                </button>
                                                <button
                                                  class="btn btn-sm btn-outline-primary"
                                                  @click="removeHistoryItem(sectionIndex, fieldIndex, historyIndex)"
                                                >
                                                  <svg
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="16"
                                                    height="16"
                                                    fill="currentColor"
                                                    class="bi bi-trash3"
                                                    viewBox="0 0 16 16"
                                                  >
                                                    <path
                                                      d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"
                                                    />
                                                  </svg>
                                                </button>
                                              </div>
                                            </div>
                                          </div>
                                          <div
                                            class="history--values rounded border p-2 bg-white"
                                          >
                                            <div class="history--grid">
                                              <div
                                                class="d-flex justify-content-end align-items-center"
                                              >
                                                <span
                                                  class="badge text-bg-light text-muted"
                                                  x-show="!historyItem.value.length"
                                                  >null</span
                                                >
                                                <span
                                                  x-show="historyItem.value.length"
                                                  class="badge text-bg-light text-muted"
                                                  x-text="historyItem.value"
                                                ></span>
                                              </div>
                                              <div
                                                class="d-flex justify-content-center align-items-center"
                                              >
                                                <svg
                                                  xmlns="http://www.w3.org/2000/svg"
                                                  width="16"
                                                  height="16"
                                                  fill="currentColor"
                                                  class="bi bi-arrow-right-short"
                                                  viewBox="0 0 16 16"
                                                >
                                                  <path
                                                    fill-rule="evenodd"
                                                    d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8"
                                                  />
                                                </svg>
                                              </div>
                                              <div
                                                class="d-flex justify-content-start align-items-center"
                                              >
                                                <span
                                                  class="badge bg-success-subtle text-success"
                                                  x-text="historyItem.valueAfter"
                                                ></span>
                                              </div>
                                            </div>
                                          </div>
                                        </section>
                                      </template>
                                    </template>
                                  </template>
                                </div>
                              </div>
                            </template>
                          </div>
                        </template>
                      </div>
                    </div>
                  </template>
                </div>
              </template>
            </div>
          </section>
        </main>
      </div>
    </div>
    <script>
      function entityComponent() {
        return {
          entities: [],
          widgetOnly: false,
          showHistory: false,
          filteredEntities: [],
          searchQuery: "",
          selectedEntity: null,
          selectedEntityIndex: 0,
          currentSection: 0,
          users: [
            { name: "Razvan Nicu", role: "admin" },
            { name: "Luna Nicu", role: "operator" },
            { name: "Calina Nicu", role: "operator" },
          ],
          activeUser: "Razvan Nicu",
          originalValues: {},
          loadData() {
            const storedEntities = localStorage.getItem("entities");
            if (storedEntities) {
              this.entities = JSON.parse(storedEntities);
              if (this.entities.length > 0) {
                this.selectEntity(this.entities[0].id, 0);
              }
            } else {
              fetch("entities.json")
                .then((response) => response.json())
                .then((data) => {
                  this.entities = data.persons_companies.map(
                    (entity, index) => ({
                      ...entity,
                      id: index + 1,
                    })
                  );
                  this.saveToLocalStorage();
                  if (this.entities.length > 0) {
                    this.selectEntity(this.entities[0].id, 0);
                  }
                });
            }
            this.filteredEntities = this.entities;
          },
          saveToLocalStorage() {
            localStorage.setItem("entities", JSON.stringify(this.entities));
          },

          saveForm() {
            this.entities.forEach((entity, entityIndex) => {
              entity.form.sections.forEach((section, sectionIndex) => {
                section.fields.forEach((field, fieldIndex) => {
                  if (
                    this.isFieldChanged(
                      entityIndex,
                      sectionIndex,
                      fieldIndex,
                      field.value
                    )
                  ) {
                    this.trackChange(
                      field,
                      this.originalValues[
                        `${entityIndex}-${sectionIndex}-${fieldIndex}`
                      ]
                    );

                    console.log(field.name);
                    if (field.name === "first_name") {
                      console.log(this.entities[entityIndex]);
                      this.entities[entityIndex].name = field.value;
                    }
                    if (field.name === "last_name") {
                      this.entities[entityIndex].surname = field.value;
                    }
                  }
                });
              });
            });
            this.saveToLocalStorage();
            alert("Form data saved successfully!");
          },

          selectEntity(entityId, index) {
            const originalIndex = this.entities.findIndex(
              (entity) => entity.id === entityId
            );
            this.selectedEntity = this.entities[originalIndex];
            this.selectedEntityIndex = index;
            this.currentSection = 0;
            this.cacheOriginalValues();
            this.$nextTick(() => {
              this.scrollToSelectedEntity();
            });
          },
          scrollToSelectedEntity() {
            let selectedElement = document.querySelector(
              '[x-ref="entity-' + this.selectedEntityIndex + '"]'
            );
            if (selectedElement) {
              selectedElement.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });
            }
          },
          scrollFormToSection(index, type) {
            let selectedElement = document.querySelector(
              '[x-ref="' + type + index + '"]'
            );
            console.log(selectedElement);

            if (selectedElement) {
              selectedElement.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });

              selectedElement.classList.add("spotted");

              setTimeout(() => {
                selectedElement.classList.remove("spotted");
              }, 3000);
            }
          },
          scrollToSection(index) {
            const sectionId = `section${index}`;
            const sectionElement = document.getElementById(sectionId);
            const container = document.getElementById("editContainer");
            if (sectionElement && container) {
              container.scrollTo({
                top: sectionElement.offsetTop - container.offsetTop,
                behavior: "smooth",
              });
            }
          },
          filterEntities() {
            if (this.searchQuery.trim() === "") {
              this.filteredEntities = this.entities;
            } else {
              const query = this.searchQuery.toLowerCase();
              this.filteredEntities = this.entities.filter((entity) => {
                const fullName =
                  entity.type === "person"
                    ? `${entity.name} ${entity.surname}`
                    : entity.name;
                return fullName.toLowerCase().includes(query);
              });
            }
            this.selectedEntity = null;
            this.selectedEntityIndex = null;
          },
          nextEntity() {
            if (this.selectedEntityIndex < this.filteredEntities.length - 1) {
              this.selectedEntityIndex++;
              const selectedEntityId =
                this.filteredEntities[this.selectedEntityIndex].id;
              this.selectEntity(selectedEntityId, this.selectedEntityIndex);
            }
          },
          previousEntity() {
            if (this.selectedEntityIndex > 0) {
              this.selectedEntityIndex--;
              const selectedEntityId =
                this.filteredEntities[this.selectedEntityIndex].id;
              this.selectEntity(selectedEntityId, this.selectedEntityIndex);
            }
          },
          duplicateEntity() {
            if (this.selectedEntity !== null) {
              const newEntity = JSON.parse(JSON.stringify(this.selectedEntity));
              newEntity.id = this.entities.length
                ? Math.max(...this.entities.map((e) => e.id)) + 1
                : 1;
              newEntity.name = `${newEntity.name} Copy`;
              this.entities.push(newEntity);
              this.updateFilteredEntities();
              this.saveToLocalStorage();
            }
          },
          updateFilteredEntities() {
            const query = this.searchQuery.toLowerCase();
            this.filteredEntities = this.entities.filter((entity) => {
              const fullName =
                entity.type === "person"
                  ? `${entity.name} ${entity.surname}`
                  : entity.name;
              return fullName.toLowerCase().includes(query);
            });
          },
          downloadData() {
            const dataStr = JSON.stringify(this.entities, null, 2);
            const dataUri =
              "data:application/json;charset=utf-8," +
              encodeURIComponent(dataStr);
            const exportFileDefaultName = "entities.json";
            const linkElement = document.createElement("a");
            linkElement.setAttribute("href", dataUri);
            linkElement.setAttribute("download", exportFileDefaultName);
            linkElement.click();
          },
          uploadData(event) {
            const file = event.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (e) => {
                const contents = e.target.result;
                this.entities = JSON.parse(contents);
                this.entities.forEach(
                  (entity, index) => (entity.id = index + 1)
                );
                this.updateFilteredEntities();
                this.saveToLocalStorage();
              };
              reader.readAsText(file);
            }
          },
          cacheOriginalValues() {
            this.originalValues = {};
            this.entities.forEach((entity, entityIndex) => {
              entity.form.sections.forEach((section, sectionIndex) => {
                section.fields.forEach((field, fieldIndex) => {
                  this.originalValues[
                    `${entityIndex}-${sectionIndex}-${fieldIndex}`
                  ] = field.value;
                });
              });
            });
          },
          isFieldChanged(entityIndex, sectionIndex, fieldIndex, newValue) {
            return (
              this.originalValues[
                `${entityIndex}-${sectionIndex}-${fieldIndex}`
              ] !== newValue
            );
          },
          trackChange(field, oldValue) {
            const currentTime = new Date().toISOString();
            const changeEntry = {
              time: currentTime,
              valueAfter: field.value,
              value: oldValue,
              user: this.activeUser,
            };
            if (!field.history) {
              field.history = [];
            }
            field.history.push(changeEntry);
          },
          countFields(sectionIndex) {
            return this.selectedEntity.form.sections[sectionIndex].fields
              .length;
          },
          countFilledFields(sectionIndex) {
            return this.selectedEntity.form.sections[
              sectionIndex
            ].fields.filter((field) => field.value).length;
          },

          calculateTimeDifference(entryTime) {
            const currentTime = new Date();
            const entryDate = new Date(entryTime);
            const diffMilliseconds = currentTime - entryDate;

            const diffDays = Math.floor(
              diffMilliseconds / (1000 * 60 * 60 * 24)
            );
            const diffHours = Math.floor(
              (diffMilliseconds % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
            );
            const diffMinutes = Math.floor(
              (diffMilliseconds % (1000 * 60 * 60)) / (1000 * 60)
            );
            const diffSeconds = Math.floor(
              (diffMilliseconds % (1000 * 60)) / 1000
            );

            if (diffDays > 0) {
              return `${diffDays} days ago`;
            } else if (diffHours > 0) {
              return `${diffHours} hr ago`;
            } else if (diffMinutes > 0) {
              return `${diffMinutes} min ago`;
            } else {
              return `${diffSeconds} sec ago`;
            }
          },

          getRole(name) {
            const user = this.users.find((user) => user.name === name);
            return user ? user.role : null;
          },

          entityHasHistory(entity) {
            return entity.form.sections.some((section) =>
              section.fields.some(
                (field) => field.history && field.history.length > 0
              )
            );
          },

          get hasNext() {
            return (
              this.selectedEntityIndex !== null &&
              this.selectedEntityIndex < this.filteredEntities.length - 1
            );
          },

          removeHistoryItem(sectionIndex, fieldIndex, historyIndex) {
            const field =
              this.selectedEntity.form.sections[sectionIndex].fields[
                fieldIndex
              ];
            const history = field.history.slice().reverse();
            if (historyIndex >= 0 && historyIndex < history.length) {
              field.history.splice(field.history.length - 1 - historyIndex, 1);
              this.saveToLocalStorage();
            }
          },

          revertHistoryItem(sectionIndex, fieldIndex, historyIndex) {
            console.log(sectionIndex, fieldIndex, historyIndex);
            const field =
              this.selectedEntity.form.sections[sectionIndex].fields[
                fieldIndex
              ];
            const history = field.history.slice().reverse();
            if (historyIndex >= 0 && historyIndex < history.length) {
              const historyItem = history[historyIndex];
              field.value = historyItem.value;
              this.saveToLocalStorage();
            }
          },

          get hasPrevious() {
            return (
              this.selectedEntityIndex !== null && this.selectedEntityIndex > 0
            );
          },
        };
      }
    </script>
  </body>
</html>
